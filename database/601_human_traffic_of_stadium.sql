Create table If Not Exists stadium (id int, date DATE NULL, people int);Truncate table stadium;insert into stadium (id, date, people) values ('1', '2017-01-01', '10');insert into stadium (id, date, people) values ('2', '2017-01-02', '109');insert into stadium (id, date, people) values ('3', '2017-01-03', '150');insert into stadium (id, date, people) values ('4', '2017-01-04', '99');insert into stadium (id, date, people) values ('5', '2017-01-05', '145');insert into stadium (id, date, people) values ('6', '2017-01-06', '1455');insert into stadium (id, date, people) values ('7', '2017-01-07', '199');insert into stadium (id, date, people) values ('8', '2017-01-08', '188');Create table If Not Exists stadium (id int, date DATE NULL, people int);Truncate table stadium;insert into stadium (id, date, people) values ('1', '2017-5-1', '150');insert into stadium (id, date, people) values ('2', '2017-5-2', '150');insert into stadium (id, date, people) values ('3', '2017-5-3', '150');insert into stadium (id, date, people) values ('4', '2017-5-4', '150');insert into stadium (id, date, people) values ('5', '2017-5-5', '50');insert into stadium (id, date, people) values ('6', '2017-5-6', '50');insert into stadium (id, date, people) values ('7', '2017-5-7', '150');insert into stadium (id, date, people) values ('8', '2017-5-8', '150');insert into stadium (id, date, people) values ('9', '2017-5-9', '150');insert into stadium (id, date, people) values ('10', '2017-5-10', '150');insert into stadium (id, date, people) values ('11', '2017-5-11', '150');insert into stadium (id, date, people) values ('12', '2017-5-12', '50');insert into stadium (id, date, people) values ('13', '2017-5-13', '50');insert into stadium (id, date, people) values ('14', '2017-5-14', '150');insert into stadium (id, date, people) values ('15', '2017-5-15', '150');insert into stadium (id, date, people) values ('16', '2017-5-16', '150');insert into stadium (id, date, people) values ('17', '2017-5-17', '150');insert into stadium (id, date, people) values ('18', '2017-5-18', '150');insert into stadium (id, date, people) values ('19', '2017-5-19', '50');insert into stadium (id, date, people) values ('20', '2017-5-20', '50');insert into stadium (id, date, people) values ('21', '2017-5-21', '150');insert into stadium (id, date, people) values ('22', '2017-5-22', '150');insert into stadium (id, date, people) values ('23', '2017-5-23', '150');insert into stadium (id, date, people) values ('24', '2017-5-24', '150');insert into stadium (id, date, people) values ('25', '2017-5-25', '150');insert into stadium (id, date, people) values ('26', '2017-5-26', '50');insert into stadium (id, date, people) values ('27', '2017-5-27', '50');insert into stadium (id, date, people) values ('28', '2017-5-28', '150');insert into stadium (id, date, people) values ('29', '2017-5-29', '150');insert into stadium (id, date, people) values ('30', '2017-6-1', '150');/*Please write a query to display the records which have (3 or more) consecutive rows and the amount of people more than 100(inclusive)*/select a.*from stadium a, (  select id_start, id_end from (    SELECT      id_start      , id_end      , case when @ke = id_start then @rnk := @rnk + 1 else @rnk := 1 end as rnk      , @ke := id_start     -- , @val :=     -- , id, date, people    FROM (           SELECT -- *,             CASE WHEN people >= 100               THEN @id_start := @id_start             ELSE @id_start := id + 1 END AS id_start,             CASE WHEN people >= 100               THEN @id_end := @id_end + 1             ELSE @id_end := id END       AS id_end           FROM stadium, (SELECT                            @id_start := 1,                            @id_end := 0) init_var         ) t, ( select @rnk := 0, @ke := 0 /*, @val := 0*/ ) init_var2    -- WHERE id_end - id_start >= 2    ORDER BY id_start, id_end - id_start desc    -- limit 1  ) tt  where rnk = 1 and id_end - id_start >= 2) b where a.id >= b.id_start and a.id <= b.id_end;drop table stadium;